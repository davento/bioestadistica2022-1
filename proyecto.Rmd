---
title: "proyecto"
output: html_document
date: '2022-06-28'
---


```{r warning=FALSE}
library(haven)
library(foreign)
library(readr) #Leer archivos
#library(tidyverse) #Manipular la data
library(lubridate) #Manipular las fechas
library(aweek) #Manipular las fechas
library(dplyr)
install.packages("modeest")
library(modeest)
```

```{r}
# Read csv file
df <- read.csv("violence_clean.csv")

# Storing only relevant variables
df <- df %>% dplyr::select(`reporting_center`, `newcase`,`year`, `crime_years`, `crime_region`, `crime_urban`, `crime_femicide_attemp`, `crime_violence_type`, `verbal_assault`, `victim_age`, `victim_children`, `victim_children_groups`, `victim_language`, `victim_civil_status`, `victim_education`, `victim_job_status`, `victim_discapacity`, `victim_filesacomplaint`, `sex_harassment`, `sex_rape`, `verbal_assault`, `thread_children`, `physical_kicks`, `physical_punches`, `physical_hairpull`, `victim_children_groups`, `treatment_psycological`, `treatment_psyquiatric`, `treatment_medic`, `bond_family_d`, `bond_family_d`, `bond_coworkers`, `bond_neighbor`, `bond_friends`, `bond_partner`, `agressor_age`, `agressor_age_group`, `agressor_gender`, `agressor_education`, `agressor_education`, `agressor_job_status`, `agressor_foreign`)

# Dep distribution used for the research
dep_coastal <- c("Moquegua", "Ica", "Lima", "Arequipa", "Tacna", "Lambayeque", "Callao", "Áncash", "La Libertad", "Piura", "Tumbes", "Callao")
dep_highland <-c("Ayacucho", "Junín", "Cusco", "Apurímac", "San Martín", "Cajamarca", "Huancavelica", "Huánuco", "Puno")
dep_jungle <- c("Amazonas", "Pasco", "Madre de Dios", "Loreto2", "Ucayali")

# Filtered data frames
df_coastal <- df %>% filter(crime_region %in% dep_coastal)
df_highland <- df %>% filter(crime_region %in% dep_highland)
df_jungle <- df %>% filter(crime_region %in% dep_jungle)
regions <- c(df_coastal, df_highland, df_jungle)
```

```{r}
analyze_single_var <- function(x){
  print("MEAN: ", mean(x, na.rm = TRUE))
  print("MEDIAN: ", median(x, na.rm = TRUE))
  print("MODE: ", mfv(x, na_rm = TRUE))
}

# Original dfs metrics
analyze_single_var(df$victim_age)
analyze_single_var(df$crime_years)
analyze_single_var(df$victim_children)

# Use different dfs
analyze_single_var(df_coastal$victim_age)
analyze_single_var(df_coastal$crime_years)
analyze_single_var(df_coastal$victim_children)
analyze_single_var(df_highland$victim_age)
analyze_single_var(df_highland$crime_years)
analyze_single_var(df_highland$victim_children)
analyze_single_var(df_jungle$victim_age)
analyze_single_var(df_jungle$crime_years)
analyze_single_var(df_jungle$victim_children)
```

```{r}
#Dimension del data frame (filas y columnas)
dim(db) 

# Nos muestra las primeras 15 observaciones
head(db, n = 15) 
```

```{r}
summary(df[1:10]) 
```


```{r}
class(df$victim_lgbti)
unique(df$victim_lgbti)
```

```{r}
total = length(db$victim_lgbti)
cases = sum(db$victim_lgbti == "Negative")

100 - cases / total * 100
```



```{r}
table(db$victim_education)
table(db$econ_income_control)
table(db$econ_money_restriction)
```


```{r}
unfilter_df <- read.csv("violence_2021.csv")
```








